(function(b){b.fn.extend({simpleGallery:function(h,m){var f,a=b(this);h=b.extend({width:160,height:400,source:"file",folder:"images",previewHeight:"90%",previewWidth:"90%"},h);var d=b('<div class = "picholder bgcol outsh" ><div class = "moveleft"><a>PREW</a></div><div class = "picdiv "></div><div class = "picInfo"></div><img class="close" src = "css/img/close.png"><div class = "moveright"><a>NEXT</a></div></div>').hide().appendTo("body");return this.each(function(){function k(g){f=g;0==f.prev().length?
d.children(".moveleft").fadeOut():d.children(".moveleft").fadeIn();0==f.next().length?d.children(".moveright").fadeOut():d.children(".moveright").fadeIn();d.children(".picdiv").children("img").remove("img");var a=b('<img style = "height:100%;opacity:0;filter: Alpha(Opacity=0);">'),l=g.attr("name"),n=0.7*b(window).width(),p=0.7*b(window).height();d.children(".picInfo").html("<a>"+l+" - ( "+(f.index()+1)+" / "+c.children("img").length+" )</a>");"file"==e.source?a.attr("src","resizer.php?order=file&dir="+
e.folder+"&wh="+n+"&he="+p+"&file="+l):(g=g.attr("dbid"),a.attr("src","resizer.php?order=database&id="+g+"&wh="+n+"&he="+p+"&file="+l));d.children(".picdiv").append(a);a.load(function(){mostleft=d.children(".picdiv").width()>a.width()?d.position().left+(d.width()-a.width()-20)/2:d.position().left-(a.width()+20-d.width())/2;mostwidth=a.width()+20;d.animate({left:mostleft,width:mostwidth},300,"swing",function(){a.animate({opacity:1},300,"swing")})});d.fadeIn()}function u(){target=0;b.each(c.children("img"),
function(a){if(b(this).position().top>=c.height())return target=b(this).prev().position().top,!1;a==c.children("img").length-1&&(target=c[0].scrollHeight-c.height())});c.animate({scrollTop:c.scrollTop()+target},300,"swing")}function v(){target=0;b.each(c.children("img"),function(a){if(Math.abs(b(this).position().top)<=c.height())return target=b(this).position().top,!1});c.animate({scrollTop:c.scrollTop()+target},300,"swing")}function w(){target=0;b.each(c.children("img"),function(a){if(b(this).position().left>=
c.width())return target=b(this).prev().position().left,!1;a==c.children("img").length-1&&(target=c[0].scrollWidth-c.width())});c.animate({scrollLeft:c.scrollLeft()+target},300,"swing")}function x(){target=0;b.each(c.children("img"),function(a){if(Math.abs(b(this).position().left)<=c.width())return target=b(this).position().left,!1});c.animate({scrollLeft:c.scrollLeft()+target},300,"swing")}function q(a){"enable"==a?(a=b(document).height(),b("body").append("<div id='overlay'></div>"),b("#overlay").height(a).fadeIn()):
b("#overlay").fadeOut(function(){b("#overlay").remove()})}var e=h;d.css("height",e.previewHeight.match(/\d+/g)[0]+"%");d.css("top",(100-Number(e.previewHeight.match(/\d+/g)[0]))/2+"%");d.css("width",e.previewWidth.match(/\d+/g)[0]+"%");d.css("left",(100-Number(e.previewWidth.match(/\d+/g)[0]))/2+"%");if(e.height>e.width){a.addClass("galleryHolder");a.append(b('<div class = "scroller"></div>'));var c=a.children(".scroller");a.append('<div class = "down"><img src = "css/img/arrow_down.png"></div>');
var r=a.children(".down");a.prepend('<div class = "up"><img src = "css/img/arrow_up.png"></div>');var s=a.children(".up")}else a.addClass("galleryHolder"),a.append(b('<div class = "scrollerHorizontal"></div>')),c=a.children(".scrollerHorizontal"),a.append('<div class = "downHorizontal"><img src = "css/img/arrow_right.png"></div>'),r=a.children(".downHorizontal"),a.prepend('<div class = "upHorizontal"><img src = "css/img/arrow_left.png"></div>'),s=a.children(".upHorizontal");c.width(e.width);c.height(e.height);
var t=function(a,c){returnvalue=[];b.ajax({url:"resizer.php",type:"POST",dataType:"json",async:!1,data:{order:a,param:c},complete:function(a,b){},success:function(a,b,c){returnvalue=a},error:function(a,b,c){}});return returnvalue}(e.source,e.folder);e.height>e.width?(wh=e.width-20,he=e.height-20,prev="preview"):(wh=e.width-20,he=e.height-20,prev="previewHorizontal");b.each(t,function(a){file=t[a];retImage="file"==e.source?b('<img name = "'+file.name+'" src = resizer.php?order=file&dir='+e.folder+
"&wh="+wh+"&he="+he+"&file="+file.name+' class = "'+prev+'">'):b('<img name = "'+file.name+'" dbid = "'+file.id+'" src = resizer.php?order=database&id='+file.id+"&wh="+wh+"&he="+he+"&file="+file.name+' class = "'+prev+'">');c.append(retImage)});images=c.children("img");r.on("click",function(){e.height>e.width?u():w()});s.on("click",function(){e.height>e.width?v():x()});d.on("click",".close",function(){d.fadeOut();q("remove")});images.on("click",function(){q("enable");f=b(this);k(b(this))});d.children(".moveleft").on("click",
function(){d.children(".picdiv").children("img").animate({opacity:0},300,"swing",function(){k(f.prev())})});d.children(".moveright").on("click",function(){d.children(".picdiv").children("img").animate({opacity:0},300,"swing",function(){k(f.next())})});"function"==typeof m&&m.call(this)})}})})(jQuery);
